import xlsxwriter
work_book = xlsxwriter.Workbook("Results.xlsx")
worksheet=work_book.add_worksheet("Results")
merge_format = work_book.add_format({
    'align': 'center'})

def write_to_excel(result):
    worksheet.write(0, 0, "Student USN")
    worksheet.write(0, 1, "Student Name")
    worksheet.merge_range('C1:F1', '15CS51', merge_format)
    worksheet.merge_range('G1:J1', '15CS52', merge_format)
    worksheet.merge_range('K1:N1', '15CS53', merge_format)
    worksheet.merge_range('O1:R1', '15CS54', merge_format)
    worksheet.merge_range('S1:V1', '15CSL57', merge_format)
    worksheet.merge_range('W1:Z1', '15CSL58', merge_format)
    worksheet.merge_range('AA1:AD1', '15ME562', merge_format)
    worksheet.merge_range('AE1:AH1', '15CS564', merge_format)
    worksheet.merge_range('AI1:AL1', '15CS562', merge_format)
    worksheet.merge_range('AM1:AP1', '15PHY561', merge_format)
    worksheet.merge_range('AQ1:AT1', '15CS553', merge_format)
    j = 2
    for i in range(0, 11):
        worksheet.write(1, j, "IA")
        worksheet.write(1, j + 1, "EA")
        worksheet.write(1, j + 2, "Total")
        worksheet.write(1, j + 3, "Result")
        j += 4
    row = 2
    for obj in result:
        worksheet.write(row, 0, obj["USN"])
        worksheet.write(row, 1, obj["Name"])
        worksheet.write(row, 2, obj["15CS51"][0])
        worksheet.write(row, 3, obj["15CS51"][1])
        worksheet.write(row, 4, obj["15CS51"][2])
        worksheet.write(row, 5, obj["15CS51"][3])
        worksheet.write(row, 6, obj["15CS52"][0])
        worksheet.write(row, 7, obj["15CS52"][1])
        worksheet.write(row, 8, obj["15CS52"][2])
        worksheet.write(row, 9, obj["15CS52"][3])
        worksheet.write(row, 10, obj["15CS53"][0])
        worksheet.write(row, 11, obj["15CS53"][1])
        worksheet.write(row, 12, obj["15CS53"][2])
        worksheet.write(row, 13, obj["15CS53"][3])
        worksheet.write(row, 14, obj["15CS54"][0])
        worksheet.write(row, 15, obj["15CS54"][1])
        worksheet.write(row, 16, obj["15CS54"][2])
        worksheet.write(row, 17, obj["15CS54"][3])
        worksheet.write(row, 18, obj["15CSL57"][0])
        worksheet.write(row, 19, obj["15CSL57"][1])
        worksheet.write(row, 20, obj["15CSL57"][2])
        worksheet.write(row, 21, obj["15CSL57"][3])
        worksheet.write(row, 22, obj["15CSL58"][0])
        worksheet.write(row, 23, obj["15CSL58"][1])
        worksheet.write(row, 24, obj["15CSL58"][2])
        worksheet.write(row, 25, obj["15CSL58"][3])
        worksheet.write(row, 26, obj["15ME562"][0])
        worksheet.write(row, 27, obj["15ME562"][1])
        worksheet.write(row, 28, obj["15ME562"][2])
        worksheet.write(row, 29, obj["15ME562"][3])
        worksheet.write(row, 30, obj["15CS564"][0])
        worksheet.write(row, 31, obj["15CS564"][1])
        worksheet.write(row, 32, obj["15CS564"][2])
        worksheet.write(row, 33, obj["15CS564"][3])
        worksheet.write(row, 34, obj["15CS562"][0])
        worksheet.write(row, 35, obj["15CS562"][1])
        worksheet.write(row, 36, obj["15CS562"][2])
        worksheet.write(row, 37, obj["15CS562"][3])
        worksheet.write(row, 38, obj["15PHY561"][0])
        worksheet.write(row, 39, obj["15PHY561"][1])
        worksheet.write(row, 40, obj["15PHY561"][2])
        worksheet.write(row, 41, obj["15PHY561"][3])
        worksheet.write(row, 42, obj["15CS553"][0])
        worksheet.write(row, 43, obj["15CS553"][1])
        worksheet.write(row, 44, obj["15CS553"][2])
        worksheet.write(row, 45, obj["15CS553"][3])
        row += 1
    return


def close():
    work_book.close()
